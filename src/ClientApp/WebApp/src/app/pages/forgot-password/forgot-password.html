<div class="forgot-password-container">
  <mat-card class="forgot-password-card">
    <mat-card-header>
      <mat-card-title>{{ 'forgotPassword.title' | translate }}</mat-card-title>
    </mat-card-header>
    
    <mat-card-content>
      @if (successMessage()) {
        <div class="success-message">{{ successMessage() }}</div>
      }
      
      @if (errorMessage()) {
        <div class="error-message">{{ errorMessage() }}</div>
      }

      <mat-stepper [linear]="true" #stepper [selectedIndex]="currentStep()">
        <!-- Step 1: Enter Email -->
        <mat-step [stepControl]="emailForm">
          <ng-template matStepLabel>{{ 'forgotPassword.enterEmail' | translate }}</ng-template>
          <form [formGroup]="emailForm">
            <p>{{ 'forgotPassword.emailDescription' | translate }}</p>
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>{{ 'forgotPassword.email' | translate }}</mat-label>
              <input matInput formControlName="email" type="email" autocomplete="email">
            </mat-form-field>
            <div class="button-group">
              <button mat-raised-button  (click)="sendResetCode()" [disabled]="isLoading() || emailForm.invalid">
                {{ 'forgotPassword.sendCode' | translate }}
              </button>
              <button mat-button (click)="goToLogin()">
                {{ 'forgotPassword.cancel' | translate }}
              </button>
            </div>
          </form>
        </mat-step>

        <!-- Step 2: Reset Password -->
        <mat-step [stepControl]="resetForm">
          <ng-template matStepLabel>{{ 'forgotPassword.resetPassword' | translate }}</ng-template>
          <form [formGroup]="resetForm">
            <p>{{ 'forgotPassword.codeDescription' | translate }}</p>
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>{{ 'forgotPassword.code' | translate }}</mat-label>
              <input matInput formControlName="code" type="text">
            </mat-form-field>

            <mat-form-field appearance="outline" class="full-width">
              <mat-label>{{ 'forgotPassword.newPassword' | translate }}</mat-label>
              <input matInput formControlName="newPassword" type="password" autocomplete="new-password">
            </mat-form-field>

            <mat-form-field appearance="outline" class="full-width">
              <mat-label>{{ 'forgotPassword.confirmPassword' | translate }}</mat-label>
              <input matInput formControlName="confirmPassword" type="password" autocomplete="new-password">
            </mat-form-field>

            <div class="button-group">
              <button mat-raised-button  (click)="resetPassword()" [disabled]="isLoading() || resetForm.invalid">
                {{ 'forgotPassword.submit' | translate }}
              </button>
              <button mat-button (click)="goToLogin()">
                {{ 'forgotPassword.cancel' | translate }}
              </button>
            </div>
          </form>
        </mat-step>
      </mat-stepper>
    </mat-card-content>
  </mat-card>
</div>
